\documentclass[twoside, 11pt]{article}
\usepackage[top=3cm,bottom=3cm,inner=2.5cm,outer=2.5cm]{geometry}
\usepackage{graphicx}
\usepackage[french]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lastpage}
\usepackage{fancyhdr}
\usepackage{lipsum}
\usepackage{lscape}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{setspace}
\usepackage{caption}
\usepackage{listings}

\usepackage[scaled=0.95]{helvet}
\renewcommand\familydefault{\sfdefault}
\addto\captionsfrench{\renewcommand{\tablename}{{\scshape Tableau}}}

\usepackage{titlesec}
\usepackage{xcolor}
\definecolor{Rouge}{HTML}{78362A}
\definecolor{Bleu}{HTML}{114D74}


\titleformat{\section}
  [block]
  {\color{Rouge}\Large\scshape\bfseries}
  {\color{Rouge}\thesection}
  {\baselineskip}
  {}
  [\hrule \vspace{0.5em}]

\titleformat{\subsection}
  [block]
  {\color{Bleu}\large\bfseries}
  {\color{Bleu}\thesubsection}
  {\baselineskip}
  {}


  \setlength{\parindent}{0pt}

  \providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

    \usepackage{graphicx}
    % Redefine \includegraphics so that, unless explicit options are
    % given, the image width will not exceed the width or the height of the page.
    % Images get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\ScaleWidthIfNeeded{%
     \ifdim\Gin@nat@width>\linewidth
        \linewidth
      \else
        \Gin@nat@width
      \fi
    }
    \def\ScaleHeightIfNeeded{%
      \ifdim\Gin@nat@height>0.9\textheight
        0.9\textheight
      \else
        \Gin@nat@width
      \fi
    }
    \makeatother

    \setkeys{Gin}{width=\ScaleWidthIfNeeded,height=\ScaleHeightIfNeeded,keepaspectratio}%

\fancyhead[R]{\textsc{$matiere$}}
\fancyhead[L]{\textsc{$title$}}
\fancyfoot[R]{Page \thepage \ sur \pageref{LastPage}}
\fancyfoot[L]{Matthias Lorthiois}
\fancyfoot[C]{$classe$}
\pagestyle{fancy}
\thispagestyle{plain}
\renewcommand{\headrulewidth}{0.1pt}
\renewcommand{\footrulewidth}{0.1pt}% default is 0pt

\begin{document}

$name$ \hfill $classe$ \\
$matiere$ \hfill \today\\
\hrule
\vspace{0.1cm}
\begin{center}
  \large \textsc{$title$}
\end{center}
\vspace{0.1cm}
\hrule

$body$

\end{document}